#!/usr/bin/env node
"use strict";
/**
 * FDD Session Init Hook - Auto-generated by fdd-cli
 * DO NOT EDIT MANUALLY - regenerated on each fdd init/add
 *
 * SessionStart hook that clears inject-context state file
 * Ensures fresh context injection reminders for each new session
 */

const fs = require("node:fs");
const path = require("node:path");

const STATE_FILE = path.join(__dirname, ".inject-state.json");

let _inputData = "";
process.stdin.setEncoding("utf8");
process.stdin.on("data", (chunk) => {
	_inputData += chunk;
});
process.stdin.on("end", () => {
	try {
		// Clear the inject-context state file
		if (fs.existsSync(STATE_FILE)) {
			fs.unlinkSync(STATE_FILE);
		}

		// Output success (optional context for Claude)
		const output = {
			hookSpecificOutput: {
				hookEventName: "SessionStart",
			},
		};
		console.log(JSON.stringify(output));
		process.stderr.write(" ");
		process.exit(0);
	} catch (_error) {
		// On error, continue anyway (don't block session start)
		process.stderr.write(" ");
		process.exit(0);
	}
});
